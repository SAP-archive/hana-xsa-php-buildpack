<?php

	require 'lib/verify_jwt.php';


$test_auth = "Bearer eyJhbGciOiJSUzI1NiJ9.eyJqdGkiOiJlNjkxY2QwMy05ZjY3LTQ2OWItYWE1Yy1hZDY4ODRmNjc4N2MiLCJzdWIiOiIxNjExOTMiLCJzY29wZSI6WyJvcGVuaWQiLCJ1YWEudXNlciJdLCJjbGllbnRfaWQiOiJzYi1uYS01YzlhNTA0OC03ZTRmLTQ4Y2MtYjBiOS04MmRhNTMyNGVmMzYiLCJjaWQiOiJzYi1uYS01YzlhNTA0OC03ZTRmLTQ4Y2MtYjBiOS04MmRhNTMyNGVmMzYiLCJhenAiOiJzYi1uYS01YzlhNTA0OC03ZTRmLTQ4Y2MtYjBiOS04MmRhNTMyNGVmMzYiLCJncmFudF90eXBlIjoiYXV0aG9yaXphdGlvbl9jb2RlIiwidXNlcl9pZCI6IjE2MTE5MyIsInVzZXJfbmFtZSI6IlhTQV9VU0VSIiwiZW1haWwiOiJYU0FfVVNFUkB1bmtub3duIiwiZmFtaWx5X25hbWUiOiJYU0FfVVNFUiIsImlhdCI6MTQ2NTQyMTExNiwiZXhwIjoxNDY1NDY0MzE2LCJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvdWFhL29hdXRoL3Rva2VuIiwiemlkIjoidWFhIiwiaGRiLm5hbWVkdXNlci5zYW1sIjoiPD94bWwgdmVyc2lvbj1cIjEuMFwiIGVuY29kaW5nPVwiVVRGLThcIj8-PHNhbWwyOkFzc2VydGlvbiB4bWxuczpzYW1sMj1cInVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphc3NlcnRpb25cIiBJRD1cIl9hOGM4NjFkMi04OWIwLTRjNTYtYjEyZi1mNDgzMTVjM2E5OTBcIiBJc3N1ZUluc3RhbnQ9XCIyMDE2LTA2LTA4VDIxOjIwOjE2LjM5OVpcIiBWZXJzaW9uPVwiMi4wXCI-PHNhbWwyOklzc3Vlcj5YU0Etc2FtbDwvc2FtbDI6SXNzdWVyPjxkczpTaWduYXR1cmUgeG1sbnM6ZHM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjXCI-PGRzOlNpZ25lZEluZm8-PGRzOkNhbm9uaWNhbGl6YXRpb25NZXRob2QgQWxnb3JpdGhtPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMS8xMC94bWwtZXhjLWMxNG4jXCIvPjxkczpTaWduYXR1cmVNZXRob2QgQWxnb3JpdGhtPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI3JzYS1zaGExXCIvPjxkczpSZWZlcmVuY2UgVVJJPVwiI19hOGM4NjFkMi04OWIwLTRjNTYtYjEyZi1mNDgzMTVjM2E5OTBcIj48ZHM6VHJhbnNmb3Jtcz48ZHM6VHJhbnNmb3JtIEFsZ29yaXRobT1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNlbnZlbG9wZWQtc2lnbmF0dXJlXCIvPjxkczpUcmFuc2Zvcm0gQWxnb3JpdGhtPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMS8xMC94bWwtZXhjLWMxNG4jXCIvPjwvZHM6VHJhbnNmb3Jtcz48ZHM6RGlnZXN0TWV0aG9kIEFsZ29yaXRobT1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNzaGExXCIvPjxkczpEaWdlc3RWYWx1ZT42ZUVXb1hrQWZlemV3WkhWSVAzbmpOeldRK0k9PC9kczpEaWdlc3RWYWx1ZT48L2RzOlJlZmVyZW5jZT48L2RzOlNpZ25lZEluZm8-PGRzOlNpZ25hdHVyZVZhbHVlPmRnRkhuaFJ5dnlDZGF1czd6SFJHYUxTTUJXbFZpVHRMR3NmZUYwZHRLclVaWlhEc25BYUt0Mnk2Qmh5dThZYXBINU54dXFvV3pFbkQ1S3lld1NVcExKVXQrbVQveVhJSVFKVGwvSnVIZ0hUTVZsd0FHdWMrd0tkN3ZlemZRQjdIK1kweXhFakpLR2dsVml2d0NIMVdPb3poUU1MWlZhQWJVa2xWNWg2aHRvVzhYZDRCTWF2SWRoYkJ0TmYzeU02T01tMnQ5N1grSUlOSXpjOE1RL25kczZqZHpsdVFuT2dna2FsMGI1OHJ0UjhaMkNQN0w1c01Xekk1eVlLNDNLL1EyRFpUMCs5dEIzMnhWVjZINUtqakVJRUpHSDFsaFllK0c0OUJCVlZhcmVUKzRRZlg3VjNoZTB6VkV6aUJWTk4rVkpRekIydS9DZVZ4YmxkOUdGdjRsdz09PC9kczpTaWduYXR1cmVWYWx1ZT48L2RzOlNpZ25hdHVyZT48c2FtbDI6U3ViamVjdD48c2FtbDI6TmFtZUlEIEZvcm1hdD1cInVybjpvYXNpczpuYW1lczp0YzpTQU1MOjEuMTpuYW1laWQtZm9ybWF0OnVuc3BlY2lmaWVkXCI-WFNBX1VTRVI8L3NhbWwyOk5hbWVJRD48c2FtbDI6U3ViamVjdENvbmZpcm1hdGlvbiBNZXRob2Q9XCJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6Y206YmVhcmVyXCI-PHNhbWwyOlN1YmplY3RDb25maXJtYXRpb25EYXRhIE5vdE9uT3JBZnRlcj1cIjIwMTYtMDYtMDlUMDE6MjU6MTYuMzk5WlwiLz48L3NhbWwyOlN1YmplY3RDb25maXJtYXRpb24-PC9zYW1sMjpTdWJqZWN0PjxzYW1sMjpDb25kaXRpb25zIE5vdEJlZm9yZT1cIjIwMTYtMDYtMDhUMjE6MjA6MTYuMzk5WlwiIE5vdE9uT3JBZnRlcj1cIjIwMTYtMDYtMDlUMDE6MjU6MTYuMzk5WlwiLz48c2FtbDI6QXV0aG5TdGF0ZW1lbnQgQXV0aG5JbnN0YW50PVwiMjAxNi0wNi0wOFQyMToyNToxNi4zOTlaXCIgU2Vzc2lvbk5vdE9uT3JBZnRlcj1cIjIwMTYtMDYtMDhUMjE6MzA6MTYuMzk5WlwiPjxzYW1sMjpBdXRobkNvbnRleHQ-PHNhbWwyOkF1dGhuQ29udGV4dENsYXNzUmVmPnVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphYzpjbGFzc2VzOlBhc3N3b3JkPC9zYW1sMjpBdXRobkNvbnRleHRDbGFzc1JlZj48L3NhbWwyOkF1dGhuQ29udGV4dD48L3NhbWwyOkF1dGhuU3RhdGVtZW50Pjwvc2FtbDI6QXNzZXJ0aW9uPiIsInhzLnVzZXIuYXR0cmlidXRlcyI6e30sImF1ZCI6WyJzYi1uYS01YzlhNTA0OC03ZTRmLTQ4Y2MtYjBiOS04MmRhNTMyNGVmMzYiLCJvcGVuaWQiLCJ1YWEiXX0.P1O2kQHfabetVuqjqHS2YOjdq71YeWnvi6ghBIIgVY3uMgClH1gahgte76uOk8ipHh1sioMHxS_6gi1Ea72xin9_H3pQ7dWK6ZIgVazeMSnUgaYLW45tp8yG5dCFvh70iMBQNZNTZORp2jtOJXwYKtWCQqgyBgdb1lU8shwqXO3U-QhLDj8KhQNKzK0Ad7zoyT6QqXybvPNLuIdIvTIhw2x5ey9kJvNGMMpWhW6IcjQxPvR7bujW2kWYb2xqknlRKPJoSW0a5WY-lvNGGlpZKFjx6Nz0O4AMn8bfopmTGwAEtZHO553H5zF2yGqtquW9qH4k7ovLP5DvmbqwO7H5ZQ";

// $test_auth = "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE0MTY5MjkxMDksImp0aSI6ImFhN2Y4ZDBhOTVjIiwic2NvcGVzIjpbInJlcG8iLCJwdWJsaWNfcmVwbyJdfQ.XCEwpBGvOLma4TCoh36FU7XhUbcskygS81HE1uHLf0E";

$verify_result = verify_XSA_JWT_auth($test_auth);

if ($verify_result->validated) {
	echo "Valid XS-A JWT.\n";
	echo "User: " . $verify_result->jwt_user_name . "\n";
	echo "Scope: " . dump_var($verify_result->jwt_user_scope) . "\n";
}
else {
	echo "Not a valid XS-A JWT.\n";
	echo "ERROR: " . $verify_result->output . "\n";
}

?>

